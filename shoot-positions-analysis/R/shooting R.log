# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
data <- read.csv("NBA_2004_2024_Shots/mapreduce_output.csv")
position_data <- data %>% mutate(Total_Attempts = Three.Attempts + Two.Attempts, Three_Percentage = (Three.Attempts / Total_Attempts) * 100) %>% filter(Position != "NA") %>% select(Season, Position, Three_Percentage)
ggplot(position_data, aes(x = Season, y = Three_Percentage, color = Position, group = Position)) + geom_line() + geom_point() + labs(title = "Three-Point Attempts in different position", x = "Season", y = "Three-Point Attempts (%)") + theme_minimal()+ theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45, hjust = 1))
grouped_data <- data %>% group_by(Season) %>%summarize(Three_Attempts = sum(Three.Attempts, na.rm = TRUE),Three_Made = sum(Three.Made, na.rm = TRUE),Two_Attempts = sum(Two.Attempts, na.rm = TRUE),Two_Made = sum(Two.Made, na.rm = TRUE))
data <- grouped_data %>% mutate(Total_Made = Three_Made + Two_Made, Total_Attempted = Three_Attempts + Two_Attempts, Effective_Shooting_Percentage = (Total_Made + 0.5 * Three_Made) / Total_Attempted * 100, Three_Point_Percentage = (Three_Attempts / Total_Attempted) * 100, Three_Point_Accuracy = (Three_Made / Three_Attempts) * 100)
ggplot(data, aes(x = Season, y = Three_Point_Percentage)) + geom_line(color = "purple", linewidth = 1) + geom_point(color = "purple") + labs(title = "Three-Point Attempts per season", x = "Season", y = "Three-Point Attempts (%)") + theme_minimal() + theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = Season, y = Three_Point_Accuracy)) + geom_line(color = "purple", linewidth = 1) + geom_point(color = "purple") + labs(title = "Three-Point Accuracy per season", x = "Season", y = "Accuracy (%)") + theme_minimal() + theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45, hjust = 1))
data_long <- data %>% pivot_longer(cols = c(Three_Attempts, Two_Attempts), names_to = "Type", values_to = "Attempts") %>% mutate(Type = recode(Type, "Three_Attempts" = "3pts", "Two_Attempts" = "2pts"))
ggplot(data_long, aes(x = Season, y = Attempts, color = Type, group = Type)) + geom_line(linewidth = 1) + geom_point(size = 2) + labs(title = "Shooting over seasons", x = "Season", y = "Attempts") + scale_y_continuous(labels = scales::label_number(scale = 1e-3, suffix = "K")) + scale_color_manual(values = c("3pts" = "lightblue", "2pts" = "lightgreen")) + theme_minimal() + theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = Season, y = Effective_Shooting_Percentage)) + geom_line(color = "red", linewidth = 1) + geom_point(color = "red") + labs(title = "Effective Field Goal Percentage over seasons", x = "Season", y = "eFG(%)") + theme_minimal() + theme(plot.title = element_text(hjust = 0.5),axis.text.x = element_text(angle = 45, hjust = 1))